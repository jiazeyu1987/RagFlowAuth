# 测试项清单（页签/功能覆盖）

说明：
- `P0`：阻断上线风险，必须自动化。
- `P1`：高频/高价值，建议自动化。
- `P2`：低频或边角，按时间补齐。

## 1. 认证与账号
- `AUTH-001` P0 登录成功后默认进入“智能对话”页签。
- `AUTH-002` P0 登出成功，token 清理，跳转登录页。
- `AUTH-003` P0 refresh 失败后强制回登录页。
- `AUTH-004` P0 修改密码成功后，旧密码失效、新密码可登录。
- `AUTH-005` P1 修改密码失败分支：原密码错误/两次新密码不一致/强度不达标。

## 2. 智能对话页签
- `CHAT-001` P0 发送问题后助手正常流式返回。
- `CHAT-002` P0 `<think>` 内容按增量展示，不重复累加。
- `CHAT-003` P0 引用文件列表可展开查看，chunk 可点击查看。
- `CHAT-004` P0 无下载权限用户：不显示下载按钮，但可查看。
- `CHAT-005` P1 会话新建/删除/切换后状态同步正确。
- `CHAT-006` P1 备份恢复后历史 sources/chunk 仍可显示（integration）。

## 3. 搜索页签
- `SEARCH-001` P0 多知识库勾选后搜索结果可返回。
- `SEARCH-002` P0 搜索结果“查看”走统一预览接口（含 pdf/docx/md）。
- `SEARCH-003` P1 阈值滑块变更可生效并影响结果。
- `SEARCH-004` P1 docx/pdf 在搜索入口与文档浏览入口显示一致。

## 4. 文档浏览页签
- `BROWSE-001` P0 知识库关键字过滤可用；空关键字显示全部。
- `BROWSE-002` P1 默认保留最近 5 次过滤关键词。
- `BROWSE-003` P0 预览支持类型统一：`md/pdf/docx/xlsx/xls/csv/txt`。
- `BROWSE-004` P0 无下载权限可查看不可下载。
- `BROWSE-005` P1 批量下载、批量操作权限控制正确。

## 5. 文档审核页签（上传/审批流程重点）
- `REVIEW-001` P0 审核列表加载、过滤、分页正确。
- `REVIEW-002` P0 “同意/通过”操作成功并刷新状态。
- `REVIEW-003` P0 “驳回”操作成功并刷新状态。
- `REVIEW-004` P1 冲突处理（保留旧版/覆盖）流程正确。
- `REVIEW-005` P1 预览错误兜底提示明确可恢复。

## 6. 上传文档页签（与搜索联动）
- `UPLOAD-001` P0 文件类型与大小校验正确。
- `UPLOAD-002` P0 上传成功后在浏览/审核可见。
- `UPLOAD-003` P1 上传失败（网络/API）重试与提示正确。
- `UPLOAD-004` P1 审核策略路径（需要审核/免审核）符合权限组配置。
- `UPLOAD-005` P0 上传成功后可在“搜索页签”检索命中（integration，含索引完成等待）。
- `UPLOAD-006` P0 删除文档后在“搜索页签”不可再检索到（integration，含索引删除完成等待）。

## 7. 知识配置页签（知识库配置 + 对话配置）
- `KBCFG-001` P0 知识库列表、详情加载正常。
- `KBCFG-002` P0 知识库名称/参数保存成功并刷新。
- `KBCFG-003` P0 新建知识库固定“复制配置”模式可用。
- `KBCFG-004` P0 删除知识库仅允许空库。
- `KBCFG-005` P1 对话列表、详情、保存、删除可用。
- `KBCFG-006` P0 对话知识库多选保存正确；复制对话保留勾选项。
- `KBCFG-007` P1 “清除 parsed files 绑定”后可重新切换知识库。

## 8. 管理页签（管理员）
- `ADMIN-U-001` P0 用户增删改查、分配权限组。
- `ADMIN-G-001` P0 权限组增删改查、资源范围生效。
- `ADMIN-O-001` P1 公司/部门维护 + 级联选择正确。
- `ADMIN-S-001` P1 数据安全设置保存，立即备份可执行。
- `ADMIN-S-002` P1 备份保留上限 N（1~100）策略正确。
- `ADMIN-L-001` P0 日志页按类型过滤正确。
- `ADMIN-L-002` P0 日志页按公司/部门/账号过滤正确。
- `ADMIN-L-003` P0 日志页按时间区间过滤正确。
- `ADMIN-L-004` P0 组合过滤（类型+组织+账号+时间）正确且总数准确。
- `ADMIN-L-005` P0 关键动作日志齐全：登录/登出/查看/上传/下载/删除/审批同意/审批驳回/修改密码。

## 9. 权限矩阵（跨页签）
- `RBAC-001` P0 viewer 无“上传/删除/下载”能力，但保留“查看”能力。
- `RBAC-002` P0 uploader 仅可上传，不可执行管理页 CRUD。
- `RBAC-003` P0 reviewer 仅可审核，不可越权到用户/权限组管理。
- `RBAC-004` P0 admin 拥有完整能力，且与 viewer 差异符合配置。
- `RBAC-005` P1 对同一文档，按用户权限返回一致结果（按钮显隐 + API 403/200）。

## 10. 统一预览网关（跨 4 入口一致性）
- `PREVIEW-001` P0 同一文件从“智能对话/搜索/文档浏览/文档审核”打开效果一致。
- `PREVIEW-002` P0 弹框尺寸、ESC 关闭、滚动行为一致。
- `PREVIEW-003` P0 表格类渲染（csv/xlsx）一致。
- `PREVIEW-004` P0 markdown 正确渲染而非原始文本。

## 11. 发布与运维工具（tool）
- `TOOL-001` P1 本机->测试发布流程日志完整、失败可诊断。
- `TOOL-002` P1 大分区自动选择/临时文件清理策略生效。
- `TOOL-003` P2 测试->正式发布同策略复用验证。

## 12. 端到端业务链（建议优先实现）
- `FLOW-001` P0 上传 -> 审批同意 -> 搜索命中 -> 对话引用可见 -> 日志完整。
- `FLOW-002` P0 上传 -> 审批驳回 -> 搜索不命中 -> 状态与日志一致。
- `FLOW-003` P0 删除已通过文档 -> 搜索不命中 -> 日志记录删除动作。
