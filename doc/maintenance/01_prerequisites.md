# 01 服务器与网络要求（稳定优先）

本文默认场景：内网部署（无 VPN/专线），约 200 人使用，优先稳定而非极致效率。

## 1) 推荐部署形态

- 服务器上用 Docker 运行：
  - 我们系统（前端+后端）一套 compose
  - RAGFlow 单独一套 compose
- 运维面板（可选）：Portainer CE（见 `doc/maintenance/05_ops_tooling.md`）

## 2) 服务器配置建议（经验值）

你当前配置：`8 核 / 32G / 2T / CentOS 8.1`。

### CPU / 内存

- **最低可用（已验证方向）**：`8 vCPU / 32GB`
  - 能跑起来并稳定使用，但需要更注意 ES（索引）内存与磁盘水位
- **更稳推荐**：`16 vCPU / 64GB`
  - ES/索引更不容易抖动，峰值时更稳

### 磁盘

- 系统盘：100GB
- 数据盘：建议 `1TB` 起步；你当前 `2TB` 很适合长期增长
  - RAGFlow 的 MinIO（原始文件）与 ES（索引）增长很快，稳定性很依赖磁盘空间

### 系统

- 推荐：Alibaba Cloud Linux 3 / Ubuntu 22.04 LTS
- 你当前是 CentOS 8.1：
  - **可部署可运行**
  - 但 CentOS 8 已停止官方维护（EOL），建议后续迁移到 Rocky/Alma（见 `doc/maintenance/08_centos8_notes.md`）

## 3) 网络端口（内网）

最简单的内网部署：

- 我们系统前端：`8080`
- 我们系统后端：`8001`（一般不需要给普通用户直接访问）
- RAGFlow：按你们 RAGFlow compose 的端口配置（常见 9380 或类似）

建议原则：

- 普通用户只访问前端端口（如 `8080`）
- 后端端口仅对内网管理员/受限网段开放
- RAGFlow 端口仅对内网开放

## 4) 稳定性硬要求（请务必做到）

- 数据目录必须持久化（不要放在容器里）
- 不要随意执行 `docker compose down -v`（会删除 volumes，等于删库）
- 磁盘空间必须长期监控（ES/MinIO 最容易把磁盘打满）

如果你用 `8c/32G`，建议把下面两点当成“必须项”：

- ES/索引的内存要有上限（避免把系统内存吃满导致 OOM）
- 磁盘水位要提前预警（ES/MinIO 任意一个爆盘都会引发连锁故障）

