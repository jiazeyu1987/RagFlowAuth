# 07 运维每日工作清单（建议）

目标：每天用 5–10 分钟确认“系统可用、数据安全、空间够用、风险可控”。

## 1) 可用性检查（每天）

- 我们系统前端能打开并可登录（管理员账号）
- 我们系统后端健康检查正常（例如 `/health` 或 `/docs` 可访问）
- RAGFlow Web 可打开并可登录
- RAGFlow 的关键组件容器都在运行：MySQL / ES / MinIO / Redis / Web（无频繁重启）

## 2) 资源与容量检查（每天）

- 服务器磁盘剩余空间
  - 重点关注：RAGFlow 的 ES/MinIO 数据盘（磁盘爆满会直接导致写入失败）
- 内存占用是否长期接近上限（ES 需要较多内存，接近上限容易抖动）
- CPU 是否长期满载（持续满载说明系统在“硬扛”，容易触发超时）

## 3) 日志与告警检查（每天）

- 我们系统后端近 24 小时是否有大量 5xx/异常（登录失败、权限异常、备份失败）
- RAGFlow 近 24 小时是否有错误：
  - MySQL 错误（崩溃恢复、表损坏、磁盘满）
  - ES 错误（索引写入失败、磁盘水位过高、节点异常）
  - MinIO 错误（写入失败、bucket 异常、磁盘满）

> 建议：如果使用 Portainer/Grafana，把“错误计数/重启次数/磁盘水位”做成一屏总览。

## 4) 备份与可恢复性（每天/每周）

- 每天确认“数据安全”备份任务是否成功（至少 1 次成功记录）
- 每周至少做一次“抽样恢复验证”（在测试机）：
  - 恢复 `migration_pack` 后能登录
  - RAGFlow 知识库数量/关键知识库存在

## 5) 变更与发布（有变更当天）

- 发布前：
  - 先做一次迁移包备份（`migration_pack`）
  - 确认备份目录可用且空间足够
- 发布后：
  - 验证登录/知识库/上传下载/审核等关键链路
  - 观察 30 分钟：错误率、重启次数是否异常

## 6) 每周/每月维护（建议）

### 每周
- 清点备份存储空间（迁移包增长很快，必要时归档到更大盘/对象存储）
- 复核管理员账号/权限组是否有异常变更（审计）

### 每月
- 做一次完整“演练”：在一台新机器按发布 ZIP + migration_pack 完整恢复
- 评估容量：ES/MinIO 增长趋势，提前扩盘

